# 数据库设计

通过前面的需求分析和接口设计，我们已经清楚了项目所产生的数据以及数据之间的联系，并建立了相应的数据模型。因此数据库设计阶段，只需要选择适当的数据类型、必要的条件约束来建立相应的数据表即可。

## 基础设计

本项目在进行数据库设计的时候，遵循以下原则

- 索引相关
  - 需要频繁查询的字段，使用单索引、组合索引来提高查询效率
  - 对具备唯一性的字段，使用唯一索引来保证数据的唯一性
  - 允许适当增加冗余字段，减少联表查询，从而提高查询效率
- 记录相关
  - 所有记录都使用自增长主键
  - 所有记录都具备两个时间戳：创建时间 和 更新时间
    - 时间戳可以作为查询业务问题时的后悔药：在应用程序缺失日志记录的时候，还能由记录的时间戳信息推测事件发生的时间范围，提高问题处理的效率
    - 时间戳可以用于查询指定时间范围内的数据，从而进行业务数据的分析
  - 所有表示价格的字段，由于涉及商业计算中浮点数丢失精度的问题，一律使用 `DECIMAL` 数据类型，对应 Java 中的 `BigDecimal` 类型，单位是元，保留两位小数
- 其他
  - 一律不使用外键和触发器，否则在后续进行分库分表、数据清洗的时候会比较麻烦。
